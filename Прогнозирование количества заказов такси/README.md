# Прогнозирование количества заказов такси на следующий час  
## Компания «Чётенькое такси»

**Статус:** завершён  
**Тип проекта:** Data Science / Машинное обучение  

---

## Кратко о проекте
Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах для прогнозирования спроса. Цель проекта — спрогнозировать количество заказов такси на следующий час для оптимизации привлечения водителей в периоды пиковой нагрузки. Построена модель для прогнозирования с использованием временных рядов.

---

## Цель
- Прогнозировать количество заказов такси на следующий час  
- Оценить качество моделей по метрике RMSE  
- Снизить расходы на привлечение водителей за счет точных прогнозов  

---

## Данные
- **Файл:** `taxi.csv`
- **Столбцы:**
  - `datetime` — дата и время заказа (временная метка)
  - `num_orders` — количество заказов такси (целевая переменная)

**Характеристики данных:**
- Период: с 1 марта 2018 по 31 августа 2018
- Частота: данные с интервалом 10 минут
- Объем: 26,496 записей

---

## Подход
- Загрузка и первичная обработка данных  
- Визуализация и анализ временного ряда  
- Feature engineering для временных признаков и лагов  
- Обучение и настройка моделей регрессии  
- Оценка качества моделей с использованием RMSE  

---

## Модели
- Линейная регрессия  
- Случайный лес  
- Решающее дерево  
- LightGBM (лучшая модель)

**Метрика:** RMSE  

---

## Результаты
**LightGBMRegressor**  
- RMSE (Test): **41.65**  (Лучшая модель)  
- RMSE (CV): **24.70**  

**Сравнение моделей (RMSE на тестовой выборке):**
- LightGBMRegressor: **41.65**   
- LinearRegression: **41.91**  
- RandomForestRegressor: **43.51**  
- DecisionTreeRegressor: **53.56**  

**Кросс-валидационные результаты (средний RMSE):**
- LinearRegression: **25.44**  
- LightGBMRegressor: **24.70**  
- DecisionTreeRegressor: **29.53**  
- RandomForestRegressor: **23.65**   

### Закономерности:
- **Тренд:** стабильный рост числа заказов с марта по август с ускорением в августе  
- **Суточная сезонность:** пики — 00:00, 14:00, 16:00; минимум — 5:00-7:00 утра  
- **Недельная сезонность:** больше заказов в пятницу и понедельник  
- **24-часовой цикл:** устойчивый суточный паттерн с постоянной амплитудой колебаний

---

## Бизнес-выводы
- **Пиковая нагрузка:** сосредоточиться на привлечении водителей в часы пик (00:00, 14:00, 16:00)  
- **Прогнозная аналитика:** использовать модель для планирования количества водителей на следующий час  
- **Динамическое ценообразование:** учитывать прогнозируемый спрос при расчете коэффициентов  
- **Мониторинг аномалий:** отслеживать отклонения от прогноза для выявления нестандартных ситуаций  

---

## Рекомендации
- Внедрить модель для прогнозирования количества заказов и оптимизации привлечения водителей  
- Учитывать сезонность и пики спроса при планировании ресурса  
- Добавить дополнительные признаки, такие как погода, праздники, события в аэропорту, для улучшения качества прогноза  

---

## Стек
Python · pandas · numpy · scikit-learn · LightGBM · matplotlib · seaborn  

---

## Итог
Проект успешно решает задачу прогнозирования спроса на такси на следующий час. Модель LightGBM с RMSE = 41.65 значительно превосходит целевое требование (48) и на 29% улучшает наивные методы прогнозирования. Модель готова к внедрению в производственную среду для оптимизации распределения водителей и улучшения качества обслуживания клиентов.
